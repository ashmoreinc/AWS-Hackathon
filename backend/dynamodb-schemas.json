{
  "Offers": {
    "TableName": "Offers",
    "KeySchema": [
      {
        "AttributeName": "PK",
        "KeyType": "HASH"
      },
      {
        "AttributeName": "SK",
        "KeyType": "RANGE"
      }
    ],
    "AttributeDefinitions": [
      {
        "AttributeName": "PK",
        "AttributeType": "S"
      },
      {
        "AttributeName": "SK",
        "AttributeType": "S"
      },
      {
        "AttributeName": "category",
        "AttributeType": "S"
      },
      {
        "AttributeName": "priority",
        "AttributeType": "N"
      },
      {
        "AttributeName": "expiration_timestamp",
        "AttributeType": "N"
      }
    ],
    "GlobalSecondaryIndexes": [
      {
        "IndexName": "category-priority-index",
        "KeySchema": [
          {
            "AttributeName": "category",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "priority",
            "KeyType": "RANGE"
          }
        ],
        "Projection": {
          "ProjectionType": "ALL"
        }
      },
      {
        "IndexName": "expiration-index",
        "KeySchema": [
          {
            "AttributeName": "category",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "expiration_timestamp",
            "KeyType": "RANGE"
          }
        ],
        "Projection": {
          "ProjectionType": "ALL"
        }
      }
    ],
    "BillingMode": "PAY_PER_REQUEST",
    "StreamSpecification": {
      "StreamEnabled": true,
      "StreamViewType": "NEW_AND_OLD_IMAGES"
    },
    "TimeToLiveSpecification": {
      "Enabled": true,
      "AttributeName": "expiration_timestamp"
    },
    "Schema": {
      "PK": "OFFER#{offer_id}",
      "SK": "METADATA",
      "offer_id": "string - unique identifier",
      "offer_name": "string - display name",
      "category": "string - product category (electronics, fashion, food, etc.)",
      "discount_type": "string - PERCENTAGE | FIXED_AMOUNT | BOGO",
      "discount_value": "number - discount amount or percentage",
      "priority": "number - 1-100, higher = more important",
      "inventory_count": "number - available redemptions",
      "expiration_timestamp": "number - Unix epoch (TTL enabled)",
      "min_purchase_amount": "number - minimum cart value",
      "max_discount_cap": "number - maximum discount in currency",
      "target_segments": "list - [premium, standard, new_user]",
      "margin_impact": "number - profit margin percentage",
      "created_at": "number - Unix epoch",
      "status": "string - ACTIVE | PAUSED | EXPIRED"
    }
  },
  "UserActivity": {
    "TableName": "UserActivity",
    "KeySchema": [
      {
        "AttributeName": "PK",
        "KeyType": "HASH"
      },
      {
        "AttributeName": "SK",
        "KeyType": "RANGE"
      }
    ],
    "AttributeDefinitions": [
      {
        "AttributeName": "PK",
        "AttributeType": "S"
      },
      {
        "AttributeName": "SK",
        "AttributeType": "S"
      },
      {
        "AttributeName": "activity_type",
        "AttributeType": "S"
      },
      {
        "AttributeName": "timestamp",
        "AttributeType": "N"
      }
    ],
    "GlobalSecondaryIndexes": [
      {
        "IndexName": "activity-type-index",
        "KeySchema": [
          {
            "AttributeName": "PK",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "activity_type",
            "KeyType": "RANGE"
          }
        ],
        "Projection": {
          "ProjectionType": "ALL"
        }
      },
      {
        "IndexName": "timestamp-index",
        "KeySchema": [
          {
            "AttributeName": "PK",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "timestamp",
            "KeyType": "RANGE"
          }
        ],
        "Projection": {
          "ProjectionType": "ALL"
        }
      }
    ],
    "BillingMode": "PAY_PER_REQUEST",
    "StreamSpecification": {
      "StreamEnabled": true,
      "StreamViewType": "NEW_AND_OLD_IMAGES"
    },
    "Schema": {
      "PK": "USER#{user_id}",
      "SK": "ACTIVITY#{timestamp}#{activity_id} | PROFILE | ENGAGEMENT_SCORE",
      "Patterns": {
        "UserProfile": {
          "PK": "USER#{user_id}",
          "SK": "PROFILE",
          "user_id": "string",
          "segment": "string - premium | standard | new_user",
          "lifetime_value": "number",
          "total_redemptions": "number",
          "engagement_score": "number - 0-100",
          "preferred_categories": "list - [category1, category2]",
          "last_active": "number - Unix epoch",
          "created_at": "number - Unix epoch"
        },
        "RedemptionHistory": {
          "PK": "USER#{user_id}",
          "SK": "ACTIVITY#{timestamp}#REDEMPTION#{redemption_id}",
          "activity_type": "REDEMPTION",
          "timestamp": "number - Unix epoch",
          "offer_id": "string",
          "category": "string",
          "discount_amount": "number",
          "order_value": "number",
          "conversion_value": "number - revenue after discount",
          "redemption_channel": "string - web | mobile | email"
        },
        "EngagementEvent": {
          "PK": "USER#{user_id}",
          "SK": "ACTIVITY#{timestamp}#ENGAGEMENT#{event_id}",
          "activity_type": "ENGAGEMENT",
          "timestamp": "number - Unix epoch",
          "event_type": "string - VIEW | CLICK | DISMISS | ADD_TO_CART",
          "offer_id": "string",
          "category": "string",
          "dwell_time_seconds": "number",
          "device_type": "string - mobile | desktop | tablet"
        },
        "EngagementScore": {
          "PK": "USER#{user_id}",
          "SK": "ENGAGEMENT_SCORE",
          "overall_score": "number - 0-100",
          "recency_score": "number - 0-100",
          "frequency_score": "number - 0-100",
          "monetary_score": "number - 0-100",
          "category_affinity": "map - {category: score}",
          "offer_fatigue_score": "number - 0-100, higher = more fatigued",
          "last_updated": "number - Unix epoch"
        }
      }
    }
  }
}
